
# -------------
#   Functions
# -------------

# Auto shorten dirs when smaller window
adjust_p9k_size()
{
  if [ $(tput cols) -gt 80 ]; then
    export POWERLEVEL9K_SHORTEN_DIR_LENGTH=80
  else
    export POWERLEVEL9K_SHORTEN_DIR_LENGTH=1
  fi
}

icon() {
  #echo -n "\ufb8a"   # scull
  #echo -n "\uf1d0"    # rebel alliance
  #echo -n "\uf6a6"    # cube
  #echo -n "\ue36e"    # alien
  #echo -n "\uf79f"    # ghost
  echo -n "\ufb44"    # filetree
}

zsh_internet_signal(){
	local signal=$(airport -I | grep agrCtlRSSI | awk '{print $2}' | sed 's/-//g')
  local noise=$(airport -I | grep agrCtlNoise | awk '{print $2}' | sed 's/-//g')
  local ethernet=$(ifconfig | grep -B 4 "inet.*broadcast" | grep -Po '^ens?[1-9]+')

  if [ ! -z $signal ] && [ $noise -gt 0 ]; then
    local SNR=$(bc <<<"scale=2; $signal / $noise")
  fi

  # No Signal
  local color='%F{yellow}'
  local symbol="\uf663" # No cloud icon

  # Excellent Signal (5 bars)
  if [[ ! -z "${signal// }" ]] && [[ $SNR -gt .40 ]] ;
    then color='%F{green}' ; symbol="\uf1eb" ; # Wifi icon
  fi

  # Good Signal (3-4 bars)
  if [[ ! -z "${signal// }" ]] && [[ ! $SNR -gt .40 ]] && [[ $SNR -gt .25 ]] ;
    then color='%F{green}' ; symbol="\uf1eb" ; # Wifi icon
  fi

  # Low Signal (2 bars)
  if [[ ! -z "${signal// }" ]] && [[ ! $SNR -gt .25 ]] && [[ $SNR -gt .15 ]] ;
    then color='%F{yellow}' ; symbol="\ufaa8" ; # Less wifi icon
  fi

  # Very Low Signal (1 bar)
  if [[ ! -z "${signal// }" ]] && [[ ! $SNR -gt .15 ]] && [[ $SNR -gt .10 ]] ;
    then color='%F{orange}' ; symbol="\ufaa8" ; # Less wifi icon
  fi


  # Wifi off
  if [[ -z "${signal// }" ]] ;
    then color='%F{yellow}' ; symbol="\uf204" ; # Toggle off icon
  fi

  # Ethernet Connection
  if [[ ! -z "${ethernet// }" ]];
    then color='%F{cyan}' ; symbol=" \ufbf1" ; # Network icon
  fi

  echo -n "%{$color%}$symbol "
}

# ------------
#   Settings
# ------------


POWERLEVEL9K_CUSTOM_ICON="icon"

# Multiline
POWERLEVEL9K_PROMPT_ON_NEWLINE=true
POWERLEVEL9K_RPROMPT_ON_NEWLINE=false
POWERLEVEL9K_PROMPT_ADD_NEWLINE=true
POWERLEVEL9K_MULTILINE_FIRST_PROMPT_PREFIX="╭"
POWERLEVEL9K_MULTILINE_LAST_PROMPT_PREFIX="╰─> $ "

# Prompt elements
POWERLEVEL9K_LEFT_PROMPT_ELEMENTS=(custom_icon dir vcs ssh dir_writable)
POWERLEVEL9K_RIGHT_PROMPT_ELEMENTS=(status background_jobs command_execution_time ssh custom_wifi_signal battery)

# Command status
POWERLEVEL9K_STATUS_VERBOSE=true
#POWERLEVEL9K_STATUS_CROSS=true

# Execution time
POWERLEVEL9K_COMMAND_EXECUTION_TIME_THRESHOLD=0

# Battery
POWERLEVEL9K_BATTERY_STAGES=($'\uF244' $'\uF243' $'\uF242' $'\uF241' $'\uF240')
POWERLEVEL9K_BATTERY_VERBOSE=true

# Internet signal
POWERLEVEL9K_CUSTOM_WIFI_SIGNAL="zsh_internet_signal"

# Shorten dirs
#POWERLEVEL9K_SHORTEN_DIR_LENGTH=1

# ----------
#   Colors
# ----------

# Default colors
DEFAULT_FOREGROUND=159 DEFAULT_BACKGROUND=238 PROMPT_COLOR=173
DEFAULT_COLOR="clear"

POWERLEVEL9K_VCS_CLEAN_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_VCS_CLEAN_FOREGROUND="010"

POWERLEVEL9K_VCS_MODIFIED_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_VCS_MODIFIED_FOREGROUND="011"

POWERLEVEL9K_VCS_UNTRACKED_BACKGROUND="$DEFAULT_BACKGROUND"
#POWERLEVEL9K_VCS_UNTRACKED_FOREGROUND="012"
POWERLEVEL9K_VCS_UNTRACKED_FOREGROUND="011"

POWERLEVEL9K_CUSTOM_ICON_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_CUSTOM_ICON_FOREGROUND="007"

POWERLEVEL9K_BATTERY_LEVEL_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_BATTERY_LEVEL_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_BATTERY_LEVEL_BACKGROUND="011"

POWERLEVEL9K_BATTERY_LOW_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_BATTERY_CHARGING_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_BATTERY_CHARGED_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_BATTERY_DISCONNECTED_BACKGROUND="$DEFAULT_BACKGROUND"

POWERLEVEL9K_COMMAND_EXECUTION_TIME_BACKGROUND='grey27'
POWERLEVEL9K_COMMAND_EXECUTION_TIME_FOREGROUND='cyan'

POWERLEVEL9K_DIR_HOME_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_DIR_HOME_FOREGROUND="158"
POWERLEVEL9K_DIR_HOME_SUBFOLDER_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_DIR_HOME_SUBFOLDER_FOREGROUND="158"
POWERLEVEL9K_DIR_WRITABLE_FORBIDDEN_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_DIR_DEFAULT_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_DIR_DEFAULT_FOREGROUND="158"
POWERLEVEL9K_DIR_ETC_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_DIR_ETC_FOREGROUND="158"
POWERLEVEL9K_DIR_NOT_WRITABLE_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_DIR_NOT_WRITABLE_FOREGROUND="158"

POWERLEVEL9K_ROOT_INDICATOR_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_ROOT_INDICATOR_FOREGROUND="red"

POWERLEVEL9K_STATUS_OK_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_STATUS_OK_FOREGROUND="green"
POWERLEVEL9K_STATUS_ERROR_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_STATUS_ERROR_FOREGROUND="red"

POWERLEVEL9K_USER_DEFAULT_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_USER_SUDO_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_USER_ROOT_BACKGROUND="$DEFAULT_BACKGROUND"

POWERLEVEL9K_CUSTOM_WIFI_SIGNAL_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_CUSTOM_WIFI_SIGNAL_FOREGROUND="123"

POWERLEVEL9K_BACKGROUND_JOBS_BACKGROUND="$DEFAULT_BACKGROUND"
POWERLEVEL9K_BACKGROUND_JOBS_FOREGROUND="123"

POWERLEVEL9K_LOAD_CRITICAL_VISUAL_IDENTIFIER_COLOR="red"
POWERLEVEL9K_LOAD_WARNING_VISUAL_IDENTIFIER_COLOR="yellow"
POWERLEVEL9K_LOAD_NORMAL_VISUAL_IDENTIFIER_COLOR="green"

POWERLEVEL9K_NETWORK_ICON=`zsh_internet_signal`
POWERLEVEL9K_CUSTOM_ICON_BACKGROUND="$DEFAULT_BACKGROUND"


# ---------
#   Icons
# ---------

POWERLEVEL9K_LEFT_SEGMENT_SEPARATOR=$'\uE0B0'
POWERLEVEL9K_RIGHT_SEGMENT_SEPARATOR=$'\uE0B2'
POWERLEVEL9K_LEFT_SEGMENT_END_SEPARATOR=' '
POWERLEVEL9K_LEFT_SUBSEGMENT_SEPARATOR=$'\uE0B1'
POWERLEVEL9K_RIGHT_SUBSEGMENT_SEPARATOR=$'\uE0B3'
POWERLEVEL9K_CARRIAGE_RETURN_ICON=$'\u21B5'
POWERLEVEL9K_CARRIAGE_RETURN_ICON=$'\u23CE'
POWERLEVEL9K_CARRIAGE_RETURN_ICON=$'\u2718'
POWERLEVEL9K_ROOT_ICON=$'\uF201'
POWERLEVEL9K_SUDO_ICON=$'\uF09C'
POWERLEVEL9K_RUBY_ICON=$'\uF219 '
POWERLEVEL9K_AWS_ICON=$'\uF270'
POWERLEVEL9K_AWS_EB_ICON=$'\U1F331 '
POWERLEVEL9K_BACKGROUND_JOBS_ICON="\u2699 "
POWERLEVEL9K_TEST_ICON=$'\uF291'
POWERLEVEL9K_TODO_ICON=$'\u2611'
POWERLEVEL9K_BATTERY_ICON=$'\U1F50B'
POWERLEVEL9K_DISK_ICON=$'\uF0A0 '
POWERLEVEL9K_OK_ICON=$'\u2714'
POWERLEVEL9K_FAIL_ICON=$'\u2718'
POWERLEVEL9K_SYMFONY_ICON='SF'
POWERLEVEL9K_NODE_ICON=$'\u2B22'
POWERLEVEL9K_APPLE_ICON=$'\uF179'
POWERLEVEL9K_WINDOWS_ICON=$'\uF17A'
POWERLEVEL9K_FREEBSD_ICON=$'\U1F608 '
POWERLEVEL9K_ANDROID_ICON=$'\uE17B'
POWERLEVEL9K_LINUX_ICON=$'\uF17C'
POWERLEVEL9K_LINUX_ARCH_ICON=$'\uF17C'
POWERLEVEL9K_LINUX_DEBIAN_ICON=$'\uF17C'
POWERLEVEL9K_LINUX_UBUNTU_ICON=$'\uF17C'
POWERLEVEL9K_LINUX_CENTOS_ICON=$'\uF17C'
POWERLEVEL9K_LINUX_COREOS_ICON=$'\uF17C'
POWERLEVEL9K_LINUX_ELEMENTARY_ICON=$'\uF17C'
POWERLEVEL9K_LINUX_MINT_ICON=$'\uF17C'
POWERLEVEL9K_LINUX_FEDORA_ICON=$'\uF17C'
POWERLEVEL9K_LINUX_GENTOO_ICON=$'\uF17C'
POWERLEVEL9K_LINUX_MAGEIA_ICON=$'\uF17C'
POWERLEVEL9K_LINUX_NIXOS_ICON=$'\uF17C'
POWERLEVEL9K_LINUX_MANJARO_ICON=$'\uF17C'
POWERLEVEL9K_LINUX_DEVUAN_ICON=$'\uF17C'
POWERLEVEL9K_LINUX_ALPINE_ICON=$'\uF17C'
POWERLEVEL9K_LINUX_AOSC_ICON=$'\uF17C'
POWERLEVEL9K_LINUX_OPENSUSE_ICON=$'\uF17C'
POWERLEVEL9K_LINUX_SABAYON_ICON=$'\uF17C'
POWERLEVEL9K_LINUX_SLACKWARE_ICON=$'\uF17C'
POWERLEVEL9K_SUNOS_ICON=$'\uF185 '
POWERLEVEL9K_HOME_ICON=$'\uF015 '
POWERLEVEL9K_HOME_SUB_ICON=$'\uF07C '
POWERLEVEL9K_FOLDER_ICON=$'\uF115 '
POWERLEVEL9K_ETC_ICON=$'\uF013 '
POWERLEVEL9K_NETWORK_ICON=$'\uF09E '
POWERLEVEL9K_LOAD_ICON=$'\uF080 '
POWERLEVEL9K_SWAP_ICON=$'\uF0E4'
POWERLEVEL9K_RAM_ICON=$'\uF0E4'
POWERLEVEL9K_SERVER_ICON=$'\uF233'
POWERLEVEL9K_VCS_UNTRACKED_ICON=$'\uF059'
POWERLEVEL9K_VCS_UNSTAGED_ICON=$'\uF06A'
POWERLEVEL9K_VCS_STAGED_ICON=$'\uF055'
POWERLEVEL9K_VCS_STASH_ICON=$'\uF01C '
POWERLEVEL9K_VCS_INCOMING_CHANGES_ICON=$'\uF01A '
POWERLEVEL9K_VCS_OUTGOING_CHANGES_ICON=$'\uF01B '
POWERLEVEL9K_VCS_TAG_ICON=$'\uf02b '
POWERLEVEL9K_VCS_BOOKMARK_ICON=$'\uF27B'
POWERLEVEL9K_VCS_COMMIT_ICON=$'\uF417 '
POWERLEVEL9K_VCS_BRANCH_ICON=$'\uF126 '
POWERLEVEL9K_VCS_REMOTE_BRANCH_ICON=$'\u2192'
POWERLEVEL9K_VCS_GIT_ICON='\uF1D3 '
POWERLEVEL9K_VCS_GIT_GITHUB_ICON='\uF113 '
POWERLEVEL9K_VCS_GIT_BITBUCKET_ICON='\uF171 '
POWERLEVEL9K_VCS_GIT_BITBUCKET_ICON='\uF1D3 '
POWERLEVEL9K_VCS_GIT_GITLAB_ICON='\uF296 '
POWERLEVEL9K_VCS_HG_ICON=$'\uF0C3 '
POWERLEVEL9K_VCS_SVN_ICON=$'(svn)'
POWERLEVEL9K_RUST_ICON=$'\uE6A8'
POWERLEVEL9K_PYTHON_ICON=$'\ue63c'
POWERLEVEL9K_SWIFT_ICON=''
POWERLEVEL9K_GO_ICON=''
POWERLEVEL9K_PUBLIC_IP_ICON=''
POWERLEVEL9K_LOCK_ICON=$'\UF023'
POWERLEVEL9K_EXECUTION_TIME_ICON=$'\uF253'
POWERLEVEL9K_SSH_ICON='(ssh)'
POWERLEVEL9K_VPN_ICON=$'\uF023'
POWERLEVEL9K_KUBERNETES_ICON=$'\U2388'
POWERLEVEL9K_DROPBOX_ICON=$'\UF16B'
POWERLEVEL9K_DATE_ICON=$'\uF073 '
POWERLEVEL9K_TIME_ICON=$'\uF017 '
POWERLEVEL9K_JAVA_ICON=$'\U2615'
POWERLEVEL9K_LARAVEL_ICON=$'\ue73f '

